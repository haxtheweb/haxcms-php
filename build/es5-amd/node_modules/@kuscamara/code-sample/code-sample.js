define(["../../@polymer/polymer/polymer-element.js","../../@polymer/polymer/lib/utils/flattened-nodes-observer.js","./themes/one-dark.js","./vendor/highlight/highlight.pack.js"],function(_polymerElement,_flattenedNodesObserver,_oneDark){"use strict";function _templateObject_4b1299b0244e11e9bbf207b071cf737b(){var data=babelHelpers.taggedTemplateLiteral(["\n    ","\n    <style include=\"code-sample-theme\" id=\"baseStyle\">\n    :host {\n      display: block;\n    }\n\n    :host([hidden]),\n    [hidden] {\n      display: none;\n    }\n\n    pre {\n      margin: 0;\n      @apply --code-sample-pre;\n    }\n\n    pre, code {\n      font-family: var(--code-sample-font-family, Operator Mono, Inconsolata, Roboto Mono, monaco, consolas, monospace);\n      font-size: var(--code-sample-font-size, 0.875rem);\n    }\n\n    .hljs {\n      padding: 0 1.25rem;\n      line-height: var(--code-sample-line-height, 1.3);\n      @apply --code-sample-hljs;\n    }\n\n    .demo:not(:empty) {\n      padding: var(--code-sample-demo-padding, 0 0 1.25rem);\n      @apply --code-sample-demo-not-empty;\n    }\n\n    .demo {\n      @apply --code-sample-demo;\n    }\n\n    #code-container {\n      position: relative;\n      @apply --code-sample-code-container;\n    }\n\n    #code-container:hover {\n      @apply --code-sample-code-container-hover;\n    }\n\n    #code-container:hover > button {\n      @apply --code-sample-code-container-hover-button;\n    }\n\n    button {\n      background: var(--code-sample-copy-button-bg-color, #e0e0e0);\n      border: none;\n      cursor: pointer;\n      display: block;\n      position: absolute;\n      right: 0;\n      top: 0;\n      text-transform: uppercase;\n      @apply --code-sample-copy-clipboard-button;\n    }\n    </style>\n\n    <div id=\"demo\" class=\"demo\"></div>\n    <slot id=\"content\"></slot>\n\n    <div id=\"code-container\">\n      <button\n        type=\"button\"\n        hidden=\"[[!copyClipboardButton]]\"\n        id=\"copyButton\"\n        title=\"Copy to clipboard\"\n        on-click=\"_copyToClipboard\">Copy</button>\n      <pre id=\"code\"></pre>\n    </div>\n    "]);_templateObject_4b1299b0244e11e9bbf207b071cf737b=function(){return data};return data}var CodeSample=function(_PolymerElement){babelHelpers.inherits(CodeSample,_PolymerElement);function CodeSample(){babelHelpers.classCallCheck(this,CodeSample);return babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(CodeSample).apply(this,arguments))}babelHelpers.createClass(CodeSample,[{key:"_themeChanged",value:function _themeChanged(theme){if(theme&&this._themeCanBeChanged()){var previousTheme=this.shadowRoot.querySelector("style:not(#baseStyle)");this.shadowRoot.replaceChild(document.importNode(theme.content,!0),previousTheme)}}},{key:"_themeCanBeChanged",value:function _themeCanBeChanged(){if(window.ShadyCSS){console.error("<code-sample>:","Theme changing is not supported in Shady DOM.");return}if("TEMPLATE"!==this.theme.tagName){console.error("<code-sample>:","theme must be a template");return}return!0}},{key:"connectedCallback",value:function connectedCallback(){var _this=this;babelHelpers.get(babelHelpers.getPrototypeOf(CodeSample.prototype),"connectedCallback",this).call(this);setTimeout(function(){if(_this.querySelector("template")){_this._observer=new _flattenedNodesObserver.FlattenedNodesObserver(_this.$.content,function(){return _this._updateContent()})}else if(_this.childNodes.length){console.error("<code-sample>:","content must be provided inside a <template> tag")}})}},{key:"disconnectedCallback",value:function disconnectedCallback(){if(this._observer){this._observer.disconnect();this._observer=null}}},{key:"_updateContent",value:function _updateContent(){if(this._code)this._code.parentNode.removeChild(this._code);if(this._demo)this.$.demo.innerHTML="";var template=this._getCodeTemplate();if(this.render){this._demo=this.$.demo.appendChild(document.importNode(template.content,!0))}this._highlight(template.innerHTML)}},{key:"_getCodeTemplate",value:function _getCodeTemplate(){var nodes=_flattenedNodesObserver.FlattenedNodesObserver.getFlattenedNodes(this.$.content);return[].filter.call(nodes,function(node){return node.nodeType===Node.ELEMENT_NODE})[0]}},{key:"_highlight",value:function _highlight(str){this._code=document.createElement("code");if(this.type)this._code.classList.add(this.type);this._code.innerHTML=this._entitize(this._cleanIndentation(str));this.$.code.appendChild(this._code);hljs.highlightBlock(this._code)}},{key:"_cleanIndentation",value:function _cleanIndentation(str){var pattern=str.match(/\s*\n[\t\s]*/);return str.replace(new RegExp(pattern,"g"),"\n")}},{key:"_entitize",value:function _entitize(str){return(str+"").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/=""/g,"").replace(/=&gt;/g,"=>").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}},{key:"_copyToClipboard",value:function _copyToClipboard(event){var copyButton=event.target,textarea=this._textAreaWithClonedContent();textarea.select();try{document.execCommand("copy",!1);copyButton.textContent="Done"}catch(err){console.error(err);copyButton.textContent="Error"}textarea.remove();setTimeout(function(){copyButton.textContent="Copy"},1e3)}},{key:"_textAreaWithClonedContent",value:function _textAreaWithClonedContent(){var textarea=document.createElement("textarea");document.body.appendChild(textarea);textarea.value=this._cleanIndentation(this._getCodeTemplate().innerHTML);return textarea}}],[{key:"template",get:function get(){return(0,_polymerElement.html)(_templateObject_4b1299b0244e11e9bbf207b071cf737b(),this.constructor.theme||_oneDark.oneDark)}},{key:"properties",get:function get(){return{copyClipboardButton:{type:Boolean,value:!1},theme:{type:String,observer:"_themeChanged"},render:{type:Boolean,value:!1},type:{type:String}}}}]);return CodeSample}(_polymerElement.PolymerElement);customElements.define("code-sample",CodeSample)});