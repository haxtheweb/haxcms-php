/**
 * Copyright 2025 btopro
 * @license Apache-2.0, see License.md for full text.
 */
import{css as t,html as e}from"../../lit/index.js";import{HAXCMSLitElementTheme as i}from"../haxcms-elements/lib/core/HAXCMSLitElementTheme.js";import{store as a}from"../haxcms-elements/lib/core/haxcms-site-store.js";import{autorun as o,toJS as r}from"../../mobx/dist/mobx.esm.js";import"../haxcms-elements/lib/ui-components/active-item/site-active-title.js";import"../haxcms-elements/lib/ui-components/magic/site-collection-list.js";import"../haxcms-elements/lib/ui-components/navigation/site-breadcrumb.js";import"../simple-cta/simple-cta.js";import{DDDAllStyles as s}from"../d-d-d/lib/DDDStyles.js";import"../simple-tooltip/simple-tooltip.js";import"../simple-icon/lib/simple-icon-button-lite.js";import"../scroll-button/scroll-button.js";import{licenseList as n}from"../license-element/license-element.js";class JourneyTheme extends i{static get tag(){return"journey-theme"}constructor(){super(),this.siteTheme="",this.dataPrimary=2,this._items=[],this.location=null,this.activeItem={},this.ancestorItem={},this.basePath=null,this.manifest={},this.t={readMore:"Read more",home:"Home"};try{this.basePath=globalThis.document.querySelector("base").href}catch(t){this.basePath=globalThis.location.origin}o((()=>{this.manifest=r(a.manifest);let t=new n;this.manifest.license&&t[this.manifest.license]&&(this.licenseName=t[this.manifest.license].name,this.licenseLink=t[this.manifest.license].link,this.licenseImage=t[this.manifest.license].image),this._items=this.getItemChildren(null)})),o((()=>{this.activeItem=r(a.activeItem)})),o((()=>{this.ancestorItem=r(a.ancestorItem)})),o((()=>{let t=r(a.location);this.location=t}))}getItemChildren(t){if(this.manifest&&this.manifest.items)return this.manifest.items.filter((e=>e.parent===t))}static get properties(){return{...super.properties,activeItem:{type:Object},ancestorItem:{type:Object},location:{type:Object},basePath:{type:String},dataPrimary:{type:String,attribute:"data-primary",reflect:!0},_items:{type:Array},licenseName:{type:String},licenseLink:{type:String},licenseImage:{type:String},siteTheme:{type:String,reflect:!0,attribute:"site-theme"}}}HAXCMSGlobalStyleSheetContent(){return[...super.HAXCMSGlobalStyleSheetContent(),t`
      :root {
        --haxcms-site-theme-low-tone: white;
        --haxcms-site-theme-high-tone: var(--ddd-theme-default-coalyGray);
        --color: light-dark(var(--haxcms-site-theme-high-tone), var(--haxcms-site-theme-low-tone));
        --bg: light-dark(var(--haxcms-site-theme-low-tone), var(--haxcms-site-theme-high-tone));
      }
      body {
        padding: var(--ddd-spacing-0);
        margin: var(--ddd-spacing-0);
        background-color: var(--haxcms-site-theme-low-tone);
      }
      journey-theme::before {
        height: 100vh;
        content: "";
        transition: var(--haxcms-site-transition);
        border-left: 8px dashed var(--haxcms-site-theme-color-2);
        position: fixed;
        top: 0;
        bottom: 0;
        left: 50%;
        margin: 0 auto;
        z-index: -1;
      }
      @media (max-width: 800px) {
        journey-theme::before {
          display: none;
        }
      }
      body.dark-mode {
        background-color: var(--haxcms-site-theme-high-tone);
        color: var(--haxcms-site-theme-low-tone);
        --color: light-dark(var(--haxcms-site-theme-high-tone), var(--haxcms-site-theme-low-tone));
        --bg: light-dark(var(--haxcms-site-theme-low-tone), var(--haxcms-site-theme-high-tone));
      }
      @media (prefers-color-scheme: dark) {
        body {
          background-color: var(--haxcms-site-theme-high-tone);
          color: var(--haxcms-site-theme-low-tone);
          --color: light-dark(var(--haxcms-site-theme-high-tone), var(--haxcms-site-theme-low-tone));
          --bg: light-dark(var(--haxcms-site-theme-low-tone), var(--haxcms-site-theme-high-tone));
        }
      }
      `]}static get styles(){return[s,super.styles,t`
        :host {
          scroll-behavior: auto;
          display: block;
          padding: var(--ddd-spacing-0);
          margin: var(--ddd-spacing-0);
          --haxcms-site-theme-color-1: var(--ddd-primary-2);
          --haxcms-site-theme-color-2: var(--ddd-primary-8);
          --haxcms-site-transition: .3s all ease-in-out;
        }

        :host([site-theme="earth"]) {
          --haxcms-site-theme-color-1: var(--ddd-primary-17);
          --haxcms-site-theme-color-2: var(--ddd-primary-18);
        }

        :host([site-theme="water"]) {
          --haxcms-site-theme-color-1: var(--ddd-primary-7);
          --haxcms-site-theme-color-2: var(--ddd-primary-1);
        }

        :host([site-theme="fire"]) {
          --haxcms-site-theme-color-1: var(--ddd-primary-11);
          --haxcms-site-theme-color-2: var(--ddd-primary-12);
        }

        :host([site-theme="sand"]) {
          --haxcms-site-theme-color-1: var(--ddd-primary-15);
          --haxcms-site-theme-color-2: var(--ddd-primary-23);
        }

        header {
          display: flex;
          text-align: center;
          justify-content: center;
          align-items: center;
          color: var(--haxcms-site-theme-low-tone);
          background-color: var(--haxcms-site-theme-color-1);
          height: 50vh;
          overflow: hidden;
          padding: var(--ddd-spacing-10);
          z-index: 1;
          transition: var(--haxcms-site-transition);
        }
        .theme-picker {
          z-index: 1;
          color: var(--haxcms-site-theme-color-2);
          background-color: var(--haxcms-site-theme-color-1);
          padding: var(--ddd-spacing-1);
          --simple-icon-width: var(--ddd-spacing-8);
          --simple-icon-height: var(--ddd-spacing-8);
        }
        header .theme-picker {
          position: absolute;
          color: var(--haxcms-site-theme-color-1);
          background-color: var(--haxcms-site-theme-color-2);
          right: var(--ddd-spacing-2);
          top: var(--ddd-spacing-2);
        }
        .lower-header-box {
          background-color: var(--haxcms-site-theme-color-2);
          transition: var(--haxcms-site-transition);
          height: var(--ddd-spacing-12);
          padding: var(--ddd-spacing-6);
          display: flex;
          justify-content: center;
          z-index: 1;
          position: relative;
        }

        .author a {
          color: var(--haxcms-site-theme-low-tone);
          text-decoration: none;
        }
        footer .author .spacing {
          display: flex;
          justify-content: space-evenly;
          align-items: center;
        }
        footer .author {
          --component-color: var(--lowContrast-override, var(--haxcms-site-theme-low-tone));
          color: var(--component-color);
        }
        footer .author .h1 {
          font-size: var(--ddd-font-size-m);
          margin: 0;
          padding: 0;
        }
        footer .author .h2 {
          font-size: var(--ddd-font-size-s);
          margin: 0;
          padding: 0;
        }
        .author-image {
          border-radius: 50%;
          width: 15vw;
          height: 15vw;
          border: 4px solid var(--haxcms-site-theme-color-2)
        }
        .author-image:hover,
        .author-image:focus-within {
          transition: var(--haxcms-site-transition);
          transform: scale(1.1);
        }
        footer .author-image {
          width: 5vw;
          height: 5vw;
          border: 4px solid var(--haxcms-site-theme-color-1)
        }
        header h1 {
          font-size: var(--ddd-font-size-4xl);
        }

        header h2 {
          font-size: var(--ddd-font-size-xl);
        }

        article {
          display: block;
        }
        .articles article {
          display: flex;
        }
        simple-icon-button-lite {
          --simple-icon-width: var(--ddd-spacing-12);
          --simple-icon-height: var(--ddd-spacing-12);
          padding: 0;
          border-radius: 50%;
        }
        simple-tooltip {
          --simple-tooltip-font-size: var(--page-section-tooltip-font-size, var(--ddd-font-size-s, 16px));
          --simple-tooltip-background: var(--page-section-tooltip-background, #000000);
          --simple-tooltip-opacity: var(--page-section-tooltip-opacity, 0.8);
          --simple-tooltip-text-color: var(--page-section-tooltip-text-color, var(--haxcms-site-theme-low-tone));
          --simple-tooltip-delay-in: var(--page-section-tooltip-delay-in, 300);
          --simple-tooltip-delay-out: var(--page-section-tooltip-delay-out, 0);
          --simple-tooltip-duration-in: var(--page-section-tooltip-duration-in, 300);
          --simple-tooltip-duration-out: var(--page-section-tooltip-duration-out, 0);
        }
        scroll-button {
          --scroll-button-color: var(--haxcms-site-theme-color-2);
          --scroll-button-background-color: var(--haxcms-site-theme-color-1);
          --simple-icon-width: var(--ddd-spacing-8);
          --simple-icon-height: var(--ddd-spacing-8);
        }
        .article-link-icon.top {
          color: var(--haxcms-site-theme-color-1);
          margin: 0 var(--ddd-spacing-3);
          padding-left: 4px;
        }
        .article-link-icon.top:not(.active) simple-icon-button-lite::part(button):hover,
        .article-link-icon.top:not(.active) simple-icon-button-lite::part(button):focus-within {
          transition: var(--haxcms-site-transition);
          transform: scale(1.05);
          background-color: white;
          opacity: 1;
        }

        .article-link-icon.top::before {
          transition: var(--haxcms-site-transition);
          border-top: 4px dashed var(--haxcms-site-theme-low-tone);
          content: "";
          display: block;
          width: 80px;
          position: absolute;
          margin-top: 22px;
        }
        .article-link-icon.top:last-of-type::before {
          display: none;
        }
        .article-link-icon.top  simple-icon-button-lite::part(button) {
          background-color: var(--haxcms-site-theme-color-2);
          transition: var(--haxcms-site-transition);
        }
        .home .article-link-icon.top  simple-icon-button-lite::part(button) {
          background-color: white;
        }
        .article-link-icon.active simple-icon-button-lite.article {
          color: var(--haxcms-site-theme-low-tone);
        }
        .article-link-icon.active  simple-icon-button-lite::part(button) {
          background-color: var(--ddd-primary-4);
        }
        a {
          display: block;
        }
        
        simple-icon-button-lite.article {
          color: var(--haxcms-site-theme-color-1);
        }
        simple-icon-button-lite::part(button) {
          height: auto;
          background-color: var(--haxcms-site-theme-low-tone);
        }
        .even .article-link-icon {
          margin-left: -20px;          
        }
        .odd .article-link-icon {
          margin-right: -28px;
        }
        
        .even {
          margin-left: 50%;
        }
        .articles a.article-link-icon {
          display: flex;
          width: 48px;
          vertical-align: middle;
          align-content: flex-end;
        }
        .odd {
          margin-right: 50%;
          flex-direction: row-reverse;
          text-align: right;
        }
        .article-wrap {
          padding: var(--ddd-spacing-10);
        }
        .article-wrap h3 {
          font-size: var(--ddd-font-size-xl);
          margin-top: 0;
        }
        .article-wrap p {
          font-size: var(--ddd-font-size-s);
          margin-left: var(--ddd-spacing-4);
          min-width: 200px;
          display: flex;
          line-height: normal;
          font-family: var(--ddd-font-secondary);
        }

        .child-pages-container {
          display: block;
          margin-bottom: var(--ddd-spacing-6);
        }

        .child-page-link {
          display: inline-block;
          width: var(--ddd-spacing-20);
          height: var(--ddd-spacing-20);
          line-height: normal;
          margin: var(--ddd-spacing-4);
        }
        .child-page-link img {
          width: var(--ddd-spacing-20);
          height: var(--ddd-spacing-20);
          border: 4px solid var(--haxcms-site-theme-color-2);
          transition: var(--haxcms-site-transition);
        }
        .child-page-link img:hover,
        .child-page-link:focus-within img {
          border-radius: 50%;
          transform: scale(1.1);
        }        
        .odd .article-wrap p {
          margin-right: var(--ddd-spacing-4);
          justify-content: right;
          min-height: var(--ddd-spacing-10);
        }
        .even .article-wrap p {
          margin-left: var(--ddd-spacing-4);
        }
        .article-wrap simple-cta {
          margin-top: var(--ddd-spacing-4);
          --component-background-color: var(--haxcms-site-theme-color-2);
          --component-color: var(--lowContrast-override, var(--haxcms-site-theme-low-tone));
        }
        .article-wrap simple-cta:hover,
        .article-wrap simple-cta:focus-visible {
          --component-color: var(--lowContrast-override, var(--haxcms-site-theme-low-tone));
          --component-background-color: var(--haxcms-site-theme-color-1);
        }
        main {
          padding: var(--ddd-spacing-10);
        }
        footer {
          display: block;
          padding: var(--ddd-spacing-10);
          background-color: var(--haxcms-site-theme-color-2);
          color: var(--haxcms-site-theme-low-tone);
          min-height: var(--ddd-spacing-5);
          transition: var(--haxcms-site-transition);
        }

        site-collection-list {
          max-width: 70vw;
          margin: 0 auto;
        }

        main.not-home {
          background-color: var(--bg);
          padding: var(--ddd-spacing-15);
          max-width: 960px;
          margin: 0 auto;
          min-height: 70vh;
        }
        article.home {
          display: none;
        }
        .home simple-icon-button-lite::part(button):hover,
        .home simple-icon-button-lite::part(button):focus-within {
          transition: var(--haxcms-site-transition);
          transform: scale(1.05);
          background-color: white;
          opacity: 1;
        }
        site-active-title {
          line-height: normal;
        }
        site-breadcrumb {
          display: flex;
          min-height: 20px;
          --site-breadcrumb-color: var(--color);
          --site-breadcrumb-last-color: var(--color);
          --site-breadcrumb-separator-color: var(--haxcms-site-theme-color-2);
          --site-breadcrumb-margin: 0 0 var(--ddd-spacing-1) 2px;
          --site-breadcrumb-separator-color: var(--haxcms-site-theme-color-1);        
          --site-breadcrumb-color-hover: var(--haxcms-site-theme-color-1);
          --site-breadcrumb-decoration-color-hover: var(--haxcms-site-theme-color-2);
        }
        :host([site-theme=""]) site-breadcrumb {
          --site-breadcrumb-color-hover: var(--haxcms-site-theme-color-2);
          --site-breadcrumb-decoration-color-hover: var(--haxcms-site-theme-color-1);
          --site-breadcrumb-separator-color: var(--haxcms-site-theme-color-2);
        }
        site-active-title h1 {
          font-size: var(--ddd-font-size-4xl);
          margin: 0;
        }
        main.home .articles article:last-of-type {
          border-bottom: none;
        }

        #scolltop {
          position: fixed;
          right: 0px;
          bottom: 125px;
          z-index: 10000;
          --simple-icon-width: 48px;
          --simple-icon-height: 48px;
          --simple-icon-button-border-radius: none;
        }

        @media (max-width: 800px) {
          header {
            height: unset;
            padding: var(--ddd-spacing-5);
          }
          .lower-header-box {
            padding: var(--ddd-spacing-2);
          }
          header h1 {
            font-size: var(--ddd-font-size-xl);
          }
          header h2 {
            font-size: var(--ddd-font-size-sm);
          }
          main {
            padding: var(--ddd-spacing-0);
          }
          main.not-home {
            padding: var(--ddd-spacing-5);
          }
          main.not-home article {
            border-bottom: none;
          }
          article {
            padding: var(--ddd-spacing-5);
            font-size: var(--ddd-font-size-3xs);
            border-bottom: 4px dashed var(--haxcms-site-theme-color-2);
          }
          site-active-title h1 {
            font-size: var(--ddd-font-size-xl);
          }
          .even {
            margin-left: unset;
          }
          .odd {
            margin-right: unset;
            text-align: unset;
          }
          .odd .article-wrap p {
            margin-right: 0;
            margin-left: 0;
            justify-content: unset;
          }
          .even .article-wrap p {
            margin-right: 0;
            margin-left: 0;
          }
          article simple-icon-button-lite.article {
            display: none;
          }
          .article-wrap simple-cta {
            margin-top: var(--ddd-spacing-2);
          }
          .article-wrap {
            padding: var(--ddd-spacing-5);
          }
          .even .article-wrap p {
            margin-left: unset;
          }
          .article-wrap p {
            min-width: unset;
            max-width: unset;
            font-size: var(--ddd-font-size-s);
          }
          footer .author .h1 {
            display: none;
          }
          footer .author .h2 {
            display: none;
          }
        } 
      `]}firstUpdated(t){super.firstUpdated(t),this.HAXCMSThemeSettings.autoScroll=!0,this.HAXCMSThemeSettings.scrollTarget=this.shadowRoot.querySelector(".lower-header-box"),this.HAXCMSThemeSettings.scrollSettings={behavior:"instant",block:"start",inline:"start"},globalThis.AbsolutePositionStateManager.requestAvailability().scrollTarget=this.HAXCMSThemeSettings.scrollTarget}toggleSiteTheme(t){switch(this.siteTheme){case"earth":this.siteTheme="water",this.dataPrimary=1;break;case"water":this.siteTheme="fire",this.dataPrimary=11;break;case"fire":this.siteTheme="sand",this.dataPrimary=23;break;case"sand":this.siteTheme="",this.dataPrimary=2;break;default:this.siteTheme="earth",this.dataPrimary=1}}render(){return e`
    <header>
      <simple-icon-button-lite icon="image:style" class="theme-picker" @click="${this.toggleSiteTheme}"></simple-icon-button-lite>
      <div class="author">
        <a href="${this.basePath}">${this.manifest.metadata.author.image?e`
          <img 
            class="author-image"
            loading="lazy"
            decoding="async"
            fetchpriority="low"
            src="${this.manifest.metadata.author.image}"
            alt="${this.manifest.metadata.author.name}"
          />`:""}
          <h1>${this.manifest.title}</h1>
          <h2>${this.manifest.description}</h2>
        </a>
      </div>
    </header>
    <div class="lower-header-box ${this.location&&"home"===this.location.route.name?"home":"not-home"}">
      <simple-tooltip for="top" position="bottom">${this.t.home}</simple-tooltip>
      <a tabindex="-1" href="${this.basePath}" class="top article-link-icon"><simple-icon-button-lite id="top" label="${this.t.home}" icon="${this.manifest.metadata.icon?this.manifest.metadata.icon:"av:album"}"></simple-icon-button-lite></a>
      ${this.location&&"home"!==this.location.route.name?e`
          ${this._items.map(((t,i)=>e`
            <simple-tooltip for="${t.id}" position="bottom">${t.title}</simple-tooltip>
            <a tabindex="-1" href="${t.slug}" class="article-link-icon top ${this.activeItem&&(t.id===this.activeItem.id||this.ancestorItem&&t.id===this.ancestorItem.id)?"active":""}"><simple-icon-button-lite id="${t.id}" class="article" icon="${t.metadata.icon?t.metadata.icon:"av:album"}"></simple-icon-button-lite></a>
          `))}`:""}
    </div>
    <main class="main ${this.location&&"home"===this.location.route.name?"home":"not-home"}"> 
      <div class="articles">
        ${this.location&&"home"===this.location.route.name?e`
          ${this._items.map(((t,i)=>e`
            <article class="post ${i%2==0?"even":"odd"}">
            <simple-tooltip for="v-${t.id}" position="${i%2==0?"left":"right"}">${t.title}</simple-tooltip>
            <a tabindex="-1" href="${t.slug}" class="article-link-icon"><simple-icon-button-lite id="v-${t.id}" class="article" icon="${t.metadata.icon?t.metadata.icon:"av:album"}"></simple-icon-button-lite></a>
              <div class="article-wrap">
                <h3>${t.title}</h3>
                <div>
                  <p>${t.description}</p>
                </div>
                ${this.getItemChildren(t.id).length>0?e`
                  <div class="child-pages-container">
                    ${this.getItemChildren(t.id).map((t=>e`
                      <simple-tooltip for="v-${t.id}" position="bottom">${t.title}</simple-tooltip>
                      <a id="v-${t.id}" href="${t.slug}" class="child-page-link">${t.metadata.image?e`<img src="${t.metadata.image}" loading="lazy"
                        decoding="async"
                        fetchpriority="low" alt="${t.title}"/>`:e`<img 
                          loading="lazy"
                          decoding="async"
                          fetchpriority="low"
                          src="${this.manifest.metadata.author.image}"
                          alt="${this.manifest.metadata.author.name}"
                        />`}
                      </a>
                      `))}
                  </div>`:""}
                <simple-cta link="${t.slug}" label="${this.t.readMore}"></simple-cta>
              </div>
            </article>
          `))}`:""}
      </div>
      <article part="transitioncontent" class="${this.location&&"home"===this.location.route.name?"home":"not-home"}">
        ${this.location&&"home"!==this.location.route.name?e`
        <site-breadcrumb></site-breadcrumb>
        <site-active-title></site-active-title>
        `:""}
        <!-- this block and names are required for HAX to edit the content of the page. contentcontainer, slot, and wrapping the slot. -->
        <div id="contentcontainer"><div id="slot">${this.location&&"home"!==this.location.route.name?e`<slot></slot>
        <site-collection-list published="true" limit="0" sort="order" parent="${this.activeItem?this.activeItem.id:null}"></site-collection-list>`:""}</div></div>
      </article>
    </main>
    <footer>
      <div class="author">
        <div class="spacing"><a href="${this.basePath}">${this.manifest.metadata.author.image?e`
          <img 
            class="author-image"
            loading="lazy"
            decoding="async"
            fetchpriority="low"
            src="${this.manifest.metadata.author.image}"
            alt="${this.manifest.metadata.author.name}"
          />`:""}
          </a>
          <div class="h1">${this.manifest.title}</div>
          <div class="h2">${this.manifest.description}</div class="h2">
          <div
            class="license-body"
            xmlns:cc="${this.licenseLink}"
            xmlns:dc="http://purl.org/dc/elements/1.1/"
          >
          ${this.licenseImage?e`
                <a
                  class="big-license-link"
                  target="_blank"
                  href="${this.licenseLink}"
                  rel="noopener noreferrer"
                  >
                  <img
                    loading="lazy"
                    decoding="async"
                    fetchpriority="low"
                    alt="${this.licenseName} graphic"
                    src="${this.licenseImage}"
                  />
                </a>
              `:""}
          </div>
          <simple-icon-button-lite icon="image:style" class="theme-picker" @click="${this.toggleSiteTheme}"></simple-icon-button-lite>
          <scroll-button></scroll-button>
        </div>
        </div>
      <slot name="footer"></slot>
    </footer>
    `}}globalThis.customElements.define(JourneyTheme.tag,JourneyTheme);export{JourneyTheme};