/**
 * Copyright 2025 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{html as e,css as t}from"../../../../../lit/index.js";import{store as i}from"../../core/haxcms-site-store.js";import{HAXCMSI18NMixin as d}from"../../core/utils/HAXCMSI18NMixin.js";import{DDD as s}from"../../../../d-d-d/d-d-d.js";import"../../core/haxcms-site-editor.js";import"../../../../page-break/lib/page-template.js";export class SiteThemeStyleGuideRoute extends(d(s)){static get tag(){return"site-theme-style-guide-route"}static get styles(){return[super.styles,t`
        :host {
          display: block;
          padding: var(--ddd-spacing-4);
        }

        .style-guide-container {
          max-width: 1200px;
          margin: 0 auto;
        }

        .style-guide-content {
          min-height: 400px;
          padding: var(--ddd-spacing-4);
        }
        
        .style-guide-editor {
          min-height: 400px;
          border: 1px solid var(--ddd-theme-default-limestoneGray);
          border-radius: var(--ddd-radius-xs);
          padding: var(--ddd-spacing-4);
          background-color: var(--ddd-theme-default-white);
        }
      `]}constructor(){super(),this.windowControllers=new AbortController,this.HAXCMSI18NMixinBase="../../../",this.styleGuideContent=""}getCachedStyleGuideContent(){const e=`${i.manifest&&i.manifest.id?i.manifest.id:"default"}-${i.manifest&&i.manifest.metadata&&i.manifest.metadata.theme&&i.manifest.metadata.theme.styleGuide?i.manifest.metadata.theme.styleGuide:"default"}`;return i._styleGuideCache&&i._styleGuideCache.has(e)?i._styleGuideCache.get(e):null}async loadStyleGuideContent(){try{const e=await i.loadStyleGuideContent();this.styleGuideContent=e,i.activeItemContent=e,this.renderStyleGuideContent(),this.requestUpdate()}catch(e){console.error("Error loading style guide:",e),this.styleGuideContent=i.getDefaultStyleGuideContent(),i.activeItemContent=this.styleGuideContent,this.renderStyleGuideContent(),this.requestUpdate()}}renderStyleGuideContent(){if(this.styleGuideContent&&this.shadowRoot){const e=globalThis.document.createElement("div");for(e.innerHTML=this.styleGuideContent;this.firstChild;)this.removeChild(this.firstChild);for(;e.firstChild;)this.appendChild(e.firstChild)}}firstUpdated(e){super.firstUpdated&&super.firstUpdated(e),this.styleGuideContent&&this.renderStyleGuideContent()}updated(e){super.updated&&super.updated(e),e.has("styleGuideContent")&&this.styleGuideContent&&this.renderStyleGuideContent()}connectedCallback(){super.connectedCallback(),this.loadStyleGuideContent(),globalThis.addEventListener("hax-store-ready",this._handleHaxStoreReady.bind(this))}disconnectedCallback(){super.disconnectedCallback(),this.windowControllers.abort(),globalThis.removeEventListener("hax-store-ready",this._handleHaxStoreReady.bind(this))}_handleHaxStoreReady(e){if(globalThis.HaxStore&&globalThis.HaxStore.requestAvailability()){let e=globalThis.HaxStore.requestAvailability();if(void 0===e.elementList["page-template"]){let t=globalThis.document.createElement("page-template");e.haxAutoloader.appendChild(t)}this.styleGuideContent&&e.activeHaxBody&&e.activeHaxBody.importContent(this.styleGuideContent)}}render(){return e`
      <div class="style-guide-container">
        <div class="style-guide-content">
          <slot></slot>
        </div>
      </div>
    `}static get properties(){return{...super.properties,styleGuideContent:{type:String}}}}globalThis.customElements.define(SiteThemeStyleGuideRoute.tag,SiteThemeStyleGuideRoute);