/**
 * Copyright 2025 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{html as t}from"../../../../../lit/index.js";import{store as e}from"../../core/haxcms-site-store.js";import{HAXCMSI18NMixin as o}from"../../core/utils/HAXCMSI18NMixin.js";import{DDD as r}from"../../../../d-d-d/d-d-d.js";export class SiteRandomRoute extends(o(r)){static get tag(){return"site-random-route"}constructor(){super(),this.windowControllers=new AbortController,this.HAXCMSI18NMixinBase="../../../",this.t.random="Random Page",this.t.navigating="Taking you to a random page...",this.t.noPages="No published pages found",this.performRandomRedirect()}getRandomPage(){if(!e.routerManifest||!e.routerManifest.items)return null;const t=e.routerManifest.items.filter((t=>(!t.metadata||!1!==t.metadata.published)&&!(!t.slug||t._internalRoute||t.slug.startsWith("x/"))));if(0===t.length)return console.warn("No published pages found for random selection"),null;return t[Math.floor(Math.random()*t.length)]}performRandomRedirect(){const t=this.getRandomPage();t&&(globalThis.history.pushState({},"",t.slug),globalThis.dispatchEvent(new PopStateEvent("popstate")))}disconnectedCallback(){this.windowControllers.abort(),super.disconnectedCallback()}render(){const e=this.getRandomPage();return t`
      <div role="status" aria-live="polite">
        ${e?t`<p>${this.t.navigating}</p>`:t`<p>${this.t.noPages}</p>`}
      </div>
    `}static get properties(){return{...super.properties}}}globalThis.customElements.define(SiteRandomRoute.tag,SiteRandomRoute);