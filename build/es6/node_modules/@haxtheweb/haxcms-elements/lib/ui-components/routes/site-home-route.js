/**
 * Copyright 2025 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{html as e}from"../../../../../lit/index.js";import{store as t}from"../../core/haxcms-site-store.js";import{HAXCMSI18NMixin as o}from"../../core/utils/HAXCMSI18NMixin.js";import{DDD as i}from"../../../../d-d-d/d-d-d.js";export class SiteHomeRoute extends(o(i)){static get tag(){return"site-home-route"}constructor(){super(),this.windowControllers=new AbortController,this.HAXCMSI18NMixinBase="../../../",this.t.home="Home Page",this.t.navigating="Taking you to the home page...",this.t.noPages="No pages found",this.performHomeRedirect()}getHomePage(){if(!t.routerManifest||!t.routerManifest.items)return null;const e=t.manifest;if(e&&e.metadata&&e.metadata.site&&e.metadata.site.homePageId&&""!==e.metadata.site.homePageId){const o=e.metadata.site.homePageId,i=t.routerManifest.items.find((e=>e.id===o));if(i&&i.slug&&!i._internalRoute&&!i.slug.startsWith("x/")){if(!i.metadata||!1!==i.metadata.published||t.isLoggedIn)return i;console.warn("Configured home page is not published, falling back to first page")}else console.warn("Configured home page ID does not exist in manifest, falling back to first page")}const o=t.routerManifest.items.filter((e=>!(!e.slug||e._internalRoute||e.slug.startsWith("x/"))&&!(!t.isLoggedIn&&e.metadata&&!1===e.metadata.published)));return 0===o.length?(console.warn("No published pages found for home redirect"),null):o[0]}performHomeRedirect(){const e=this.getHomePage();e&&(globalThis.history.pushState({},"",e.slug),globalThis.dispatchEvent(new PopStateEvent("popstate")))}disconnectedCallback(){this.windowControllers.abort(),super.disconnectedCallback()}render(){const t=this.getHomePage();return e`
      <div role="status" aria-live="polite">
        ${t?e`<p>${this.t.navigating}</p>`:e`<p>${this.t.noPages}</p>`}
      </div>
    `}static get properties(){return{...super.properties}}}globalThis.customElements.define(SiteHomeRoute.tag,SiteHomeRoute);